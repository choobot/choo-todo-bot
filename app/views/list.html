<!doctype html>
<html ng-app="todoApp">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/todo.css">
  <script src="/js/jquery-3.3.1.min.js"></script>
  <script src="/js/popper.min.js"></script>
  <script src="/js/angular.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/moment.min.js"></script>
  <script src="/js/todo.js"></script>
  <title>Choo Todo Bot</title>
</head>

<body>
  <div ng-controller="TodoListController as todoList" class="ng-cloak">
    <div class="header"><img src="{{todoList.user.oauthPicture}}" style="width:32px;"> {{todoList.user.oauthName}} <a
        href="/logout"><button type="button" class="btn btn-secondary btn-sm">Logout</button></a></div>
    <span id="working" class="{{todoList.isWorking}}">Working...</span>
    <span>{{todoList.remaining()}} of {{todoList.todos.length}} remaining</span>

    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col">Pin</th>
          <th scope="col">Done</th>
          <th scope="col">Task</th>
          <th scope="col">Due</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="todo in todoList.pinTasks()">
          <td><input type="checkbox" ng-model="todo.Pin" ng-click="todoList.setPin(todo.ID, !todo.Pin)"></td>
          <td><input type="checkbox" ng-model="todo.Done" ng-click="todoList.setDone(todo.ID, !todo.Done)"></td>
          <td><span class="done-{{todo.Done}}">{{todo.Task}}</span></td>
          <td><span class="done-{{todo.Done}}">{{todoList.formatDate(todo.Due)}} {{todoList.isOverdue(todo)}}</span></td>
          <td><a href="javascript:void(0);" data-toggle="modal" data-target="#edit-modal" ng-click="todoList.editForm(todo)">E</a></td>
        </tr>
        <tr ng-repeat="todo in todoList.nonPinTasks()">
          <td><input type="checkbox" ng-model="todo.Pin" ng-click="todoList.setPin(todo.ID, !todo.Pin)"></td>
          <td><input type="checkbox" ng-model="todo.Done" ng-click="todoList.setDone(todo.ID, !todo.Done)"></td>
          <td><span class="done-{{todo.Done}}">{{todo.Task}}</span></td>
          <td><span class="done-{{todo.Done}}">{{todoList.formatDate(todo.Due)}} {{todoList.isOverdue(todo)}}</span></td>
          <td><a hred="javascript:void(0);" data-toggle="modal" data-target="#edit-modal" ng-click="todoList.editForm(todo)">E</a></td>
        </tr>
      </tbody>
    </table>

    <!-- Modal -->
    <div class="modal fade" id="edit-modal" tabindex="-1" role="dialog" aria-labelledby="edit-modal-label"
      aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="edit-modal-label">Edit Todo</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group row">
              <label for="task-input" class="col-2 col-form-label">Task</label>
              <div class="col-10">
                <input class="form-control" type="text" value="{{todoList.editTodo.Task}}" id="task-input">
              </div>
            </div>
            <div class="form-group row">
              <label for="due-input" class="col-2 col-form-label">Due</label>
              <div class="col-10">
                <input class="form-control" type="datetime-local" value="{{todoList.editDue}}" id="due-input">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="todoList.edit()">Save</button>
          </div>
        </div>
      </div>
    </div>

  </div>

</body>

</html>